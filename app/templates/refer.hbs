{{page-title "Refer"}}

<div class="container mx-auto lg:max-w-screen-lg pt-10 pb-48 px-6">
  {{#if this.currentUser.hasJoinedReferralProgram}}
    <div class="flex justify-between items-baseline">
      <h1 class="font-semibold text-2xl text-gray-700 mb-5 flex-shrink-0">Referrals</h1>
    </div>

    {{#if this.currentUser.isAffiliate}}
      <Alert @type="error" class="mb-4">
        <p class="text-sm">
          This is the referral program page, which is intended for regular users to share with their friends. Referrals made through this link are not
          eligible for earnings.
        </p>
        <p>
          Your partner link can be found
          <LinkTo @route="partner">here</LinkTo>.
        </p>
      </Alert>
    {{/if}}

    <div class="flex flex-col md:flex-row gap-4">
      <div class="md:basis-2/3">
        <ReferralsPage::ReferralLinksContainer />
        <ReferralsPage::ReferralLinkStatsContainer @freeUsageGrants={{this.model.freeUsageGrants}} @referralLink={{this.referralLink}} class="mt-4" />
        <ReferralsPage::ReferralReferredUsersContainer
          @freeUsageGrants={{this.model.freeUsageGrants}}
          @referralLink={{this.referralLink}}
          class="mt-4"
        />
      </div>

      <ReferralsPage::ReferralFeatureCards class="md:basis-1/3 flex flex-col gap-4 [&>*:nth-child(1)]:hidden" />
    </div>

    {{! @glint-expect-error: not ts-ified yet }}
    <TestimonialList />
  {{else}}
    <div class="container mx-auto lg:max-w-screen-lg pt-10 pb-48 px-6">
      <ReferralsPage::JoinReferralProgramContainer />
    </div>
  {{/if}}
</div>